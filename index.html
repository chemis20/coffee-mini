<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>BrewPoint</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');
    body {
      font-family: 'Inter', sans-serif;
      margin: 0; padding: 16px;
      color: #fff;
      background: url('https://images.unsplash.com/photo-1509042239860-f550ce710b93?auto=format&fit=crop&w=1350&q=80') no-repeat center center/cover;
      position: relative;
    }
    body::before {
      content: "";
      position: absolute;
      top:0; left:0; width:100%; height:100%;
      background: rgba(0,0,0,0.55); /* –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ */
      z-index: -1;
    }
    h1 {
      text-align: center;
      color: #f7d7b5;
      font-weight: 700;
    }
    .section {
      margin-bottom: 32px;
    }
    .section h2 {
      color: #f7d7b5;
      font-weight: 600;
      margin: 0 0 16px 0;
    }
    .card {
      width: 180px;
      background: rgba(255,255,255,0.9);
      border-radius: 20px;
      display: inline-block;
      margin: 12px;
      box-shadow: 0 6px 14px rgba(0,0,0,.2);
      text-align: center;
      overflow: hidden;
      transition: transform .2s;
      color: #333;
    }
    .card:hover { transform: scale(1.03); }
    .card img {
      width: 100%;
      height: 120px;
      object-fit: cover;
    }
    .card h3 {
      margin: 8px 0 4px;
      font-size: 16px;
      font-weight: 600;
    }
    .card p.desc {
      font-size: 13px;
      color: #555;
      margin: 0 6px 6px;
    }
    .card .price {
      font-weight: 700;
      color: #8b5e34;
      margin-bottom: 8px;
    }
    button {
      background: #a67c52;
      color: #fff;
      border: none;
      border-radius: 14px;
      padding: 10px 14px;
      font-size: 14px;
      cursor: pointer;
      transition: .2s;
    }
    button:hover { background: #8b5e34; }
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,.7);
      z-index: 999;
      padding: 20px;
      box-sizing: border-box;
    }
    .modal-content {
      background: #fff;
      border-radius: 22px;
      padding: 24px;
      max-width: 420px;
      margin: 40px auto;
      text-align: center;
      color: #333;
    }
    .modal-content h3 { color: #6b4226; }
    .offer-btn {
      display: block;
      width: 100%;
      margin: 10px 0;
      padding: 12px;
      border-radius: 14px;
      font-size: 15px;
      background: #f1e1d0;
      border: 2px solid #a67c52;
      color: #6b4226;
      font-weight: 600;
      cursor: pointer;
      transition: .2s;
    }
    .offer-btn:hover { background: #f7ebe0; }
  </style>
</head>
<body>

<h1>–ú–µ–Ω—é BrewPoint</h1>

<!-- –ö–æ—Ñ–µ -->
<div class="section">
  <h2>–ö–æ—Ñ–µ</h2>
  <div class="card">
    <img src="https://images.unsplash.com/photo-1572442388796-11668a67e53d?auto=format&fit=crop&w=300&q=80">
    <h3>–õ–∞—Ç—Ç–µ</h3>
    <p class="desc">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –º–æ–ª–æ—á–Ω—ã–π –∫–æ—Ñ–µ</p>
    <p class="price">200‚ÇΩ</p>
    <button onclick="addToCart('–õ–∞—Ç—Ç–µ',200,'coffee')">–í –∫–æ—Ä–∑–∏–Ω—É</button>
  </div>
  <div class="card">
    <img src="https://images.unsplash.com/photo-1541167760496-1628856ab772?auto=format&fit=crop&w=300&q=80">
    <h3>–ö–∞–ø—É—á–∏–Ω–æ</h3>
    <p class="desc">–ù–∞—Å—ã—â–µ–Ω–Ω—ã–π –≤–∫—É—Å —Å –º–æ–ª–æ—á–Ω–æ–π –ø–µ–Ω–∫–æ–π</p>
    <p class="price">180‚ÇΩ</p>
    <button onclick="addToCart('–ö–∞–ø—É—á–∏–Ω–æ',180,'coffee')">–í –∫–æ—Ä–∑–∏–Ω—É</button>
  </div>
</div>

<!-- –î–µ—Å–µ—Ä—Ç—ã -->
<div class="section">
  <h2>–î–µ—Å–µ—Ä—Ç—ã</h2>
  <div class="card">
    <img src="https://images.unsplash.com/photo-1587314168485-3236d6710814?auto=format&fit=crop&w=300&q=80">
    <h3>–ö—Ä—É–∞—Å—Å–∞–Ω</h3>
    <p class="desc">–°–ª–æ—ë–Ω–æ–µ —Ç–µ—Å—Ç–æ —Å —Ö—Ä—É—Å—Ç—è—â–µ–π –∫–æ—Ä–æ—á–∫–æ–π</p>
    <p class="price">120‚ÇΩ</p>
    <button onclick="addToCart('–ö—Ä—É–∞—Å—Å–∞–Ω',120,'dessert')">–í –∫–æ—Ä–∑–∏–Ω—É</button>
  </div>
  <div class="card">
    <img src="https://images.unsplash.com/photo-1607478900766-efe13248b125?auto=format&fit=crop&w=300&q=80">
    <h3>–ß–∏–∑–∫–µ–π–∫</h3>
    <p class="desc">–ù–µ–∂–Ω—ã–π —Ç–≤–æ—Ä–æ–∂–Ω—ã–π –¥–µ—Å–µ—Ä—Ç</p>
    <p class="price">220‚ÇΩ</p>
    <button onclick="addToCart('–ß–∏–∑–∫–µ–π–∫',220,'dessert')">–í –∫–æ—Ä–∑–∏–Ω—É</button>
  </div>
</div>

<!-- –ö–æ—Ä–∑–∏–Ω–∞ -->
<div id="cart">
  <h2>–ö–æ—Ä–∑–∏–Ω–∞</h2>
  <ul id="cart-list"></ul>
  <p>–ò—Ç–æ–≥–æ: <span id="total">0</span>‚ÇΩ</p>
  <button onclick="pay()">–û–ø–ª–∞—Ç–∏—Ç—å</button>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–ø–µ—Ü–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è -->
<div id="dessertOfferModal" class="modal">
  <div class="modal-content">
    <h3>–î–æ–±–∞–≤—å—Ç–µ –¥–µ—Å–µ—Ä—Ç –∏ –ø–æ–ª—É—á–∏—Ç–µ —Å–∫–∏–¥–∫—É üç∞</h3>
    <p>–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–±–æ:</p>
    <div id="dessertOptions"></div>
    <button onclick="skipDesserts()">–ù–µ—Ç, –ø–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø–ª–∞—Ç–µ</button>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ ¬´–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–∫–∞–∑¬ª -->
<div id="checkoutModal" class="modal">
  <div class="modal-content">
    <h3>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–∫–∞–∑</h3>
    <ul id="finalList"></ul>
    <p><b>–°—É–º–º–∞ —Å–æ —Å–∫–∏–¥–∫–æ–π:</b> <span id="finalTotal">0</span>‚ÇΩ</p>
    <button onclick="closeCheckout()">–í–µ—Ä–Ω—É—Ç—å—Å—è</button>
    <button onclick="fakePay()">–û–ø–ª–∞—Ç–∏—Ç—å</button>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ ¬´–ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω¬ª -->
<div id="successModal" class="modal">
  <div class="modal-content">
    <h3>–ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω!</h3>
    <ul id="successList"></ul>
    <p>–ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞: #<span id="orderNumber">12345</span></p>
    <button onclick="closeMiniApp()">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ —á–∞—Ç</button>
  </div>
</div>

<script>
  let cart = [];
  let discount = 0;

  function addToCart(name, price, type){
    cart.push({name, price, type});
    updateCart();
  }

  function updateCart(){
    const list=document.getElementById('cart-list');
    list.innerHTML='';
    cart.forEach((item, idx)=>list.innerHTML+=`<li>${item.name} ${item.price}‚ÇΩ <button onclick="removeItem(${idx})">√ó</button></li>`);
    document.getElementById('total').textContent = calcTotal();
  }

  function removeItem(index){
    cart.splice(index, 1);
    updateCart();
  }

  function calcTotal(){
    let sum = cart.reduce((s,i)=>s+i.price,0);
    if(discount>0){ sum = Math.round(sum*(1-discount/100)); }
    return sum;
  }

  function pay(){
    if(cart.length === 0){ alert('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞'); return; }
    const hasDessert = cart.some(i => i.type === 'dessert');
    if(!hasDessert){
      showDessertOffer();
      return;
    }
    showCheckout();
  }

  function showDessertOffer(){
    const desserts = [
      {name:'–ö—Ä—É–∞—Å—Å–∞–Ω', price:120},
      {name:'–ß–∏–∑–∫–µ–π–∫', price:220}
    ];
    const container = document.getElementById('dessertOptions');
    container.innerHTML = `
      <button class="offer-btn" onclick="chooseDesserts(['${desserts[0].name}'])">+1 ${desserts[0].name} ‚Üí —Å–∫–∏–¥–∫–∞ 10%</button>
      <button class="offer-btn" onclick="chooseDesserts(['${desserts[1].name}'])">+1 ${desserts[1].name} ‚Üí —Å–∫–∏–¥–∫–∞ 10%</button>
      <button class="offer-btn" onclick="chooseDesserts(['${desserts[0].name}','${desserts[1].name}'])">+2 –¥–µ—Å–µ—Ä—Ç–∞ ‚Üí —Å–∫–∏–¥–∫–∞ 15%</button>
    `;
    document.getElementById('dessertOfferModal').style.display = 'block';
  }

  function chooseDesserts(selected){
    discount = selected.length===1 ? 10 : 15;
    selected.forEach(d => {
      if(d==='–ö—Ä—É–∞—Å—Å–∞–Ω') cart.push({name:'–ö—Ä—É–∞—Å—Å–∞–Ω (–∫–æ–º–±–æ)', price:120, type:'dessert'});
      if(d==='–ß–∏–∑–∫–µ–π–∫') cart.push({name:'–ß–∏–∑–∫–µ–π–∫ (–∫–æ–º–±–æ)', price:220, type:'dessert'});
    });
    document.getElementById('dessertOfferModal').style.display = 'none';
    updateCart();
    showCheckout();
  }

  function skipDesserts(){
    discount = 0;
    document.getElementById('dessertOfferModal').style.display = 'none';
    showCheckout();
  }

  function showCheckout(){
    document.getElementById('finalList').innerHTML = cart.map(i => `<li>${i.name} ${i.price}‚ÇΩ</li>`).join('');
    document.getElementById('finalTotal').textContent = calcTotal();
    document.getElementById('checkoutModal').style.display = 'block';
  }

  function fakePay(){
    document.getElementById('successList').innerHTML = cart.map(i => `<li>${i.name} ${i.price}‚ÇΩ</li>`).join('');
    document.getElementById('orderNumber').textContent = Math.floor(Math.random()*90000)+10000;
    document.getElementById('checkoutModal').style.display = 'none';
    document.getElementById('successModal').style.display = 'block';
  }

  function closeCheckout(){
    document.getElementById('checkoutModal').style.display = 'none';
  }

  function closeMiniApp(){
    Telegram.WebApp.sendData(JSON.stringify({command:'order', items: cart, total: calcTotal()}));
    Telegram.WebApp.close();
  }
</script>
</body>
</html>
