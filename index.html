<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>BrewPoint</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');
    body{margin:0;font-family:'Inter',sans-serif;color:#333;
         background:linear-gradient(135deg,#f7f3ee 0%,#e8d8c3 100%);}
    .section{margin:32px 8px}
    .section h2{color:#8b5e34;font-weight:600;font-size:24px;margin:0 0 16px 8px}
    .cards{display:flex;flex-wrap:wrap;gap:12px;justify-content:center}
    .card{flex:0 0 30%;max-width:190px;background:#fff;border-radius:20px;box-shadow:0 6px 16px rgba(0,0,0,.1);text-align:center;overflow:hidden}
    .card img{width:100%;height:110px;object-fit:cover;border-radius:20px 20px 0 0}
    .card h3{font-size:18px;font-weight:600;margin:10px 0 4px}
    .card p.desc{font-size:13px;color:#555;margin:0 8px 6px}
    .card .price{font-weight:600;color:#8b5e34;margin-bottom:4px}
    .card button{width:100%;background:#a67c52;color:#fff;border:none;border-radius:0 0 20px 20px;padding:10px 0;font-size:15px;cursor:pointer;transition:.2s;margin-top:-2px}
    .card button:hover{background:#8b5e34}
    .modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.45);z-index:999}
    .modal-content{background:#fff;border-radius:20px;padding:24px;max-width:320px;margin:20% auto;text-align:center}
    #cart{background:#fff;border-radius:20px;padding:20px;margin:20px 8px;box-shadow:0 4px 12px rgba(0,0,0,.1)}
    #cart-list{list-style:none;padding:0;margin:0}
    #cart-list li{display:flex;justify-content:space-between;align-items:center;padding:6px 0;border-bottom:1px solid #eee}
    .del-btn{background:#e74c3c;color:#fff;border:none;border-radius:6px;padding:4px 8px;font-size:12px;cursor:pointer}
    button.action{background:#8b5e34;color:#fff;border:none;border-radius:12px;padding:12px 24px;font-size:16px;margin:8px;cursor:pointer}
  </style>
</head>
<body>

<h1>–ú–µ–Ω—é BrewPoint</h1>

<!-- –ö–æ—Ñ–µ -->
<div class="section">
  <h2>–ö–æ—Ñ–µ</h2>
  <div class="cards">
    <div class="card">
      <img src="https://images.unsplash.com/photo-1572442388796-11668a67e53d?auto=format&fit=crop&w=300&q=80">
      <h3>–õ–∞—Ç—Ç–µ</h3>
      <p class="desc">–ú–æ–ª–æ—á–Ω—ã–π –∫–æ—Ñ–µ</p>
      <p class="price">200‚ÇΩ</p>
      <button onclick="openModal('–õ–∞—Ç—Ç–µ',200)">–í –∫–æ—Ä–∑–∏–Ω—É</button>
    </div>
    <div class="card">
      <img src="https://images.unsplash.com/photo-1541167760496-1628856ab772?auto=format&fit=crop&w=300&q=80">
      <h3>–ö–∞–ø—É—á–∏–Ω–æ</h3>
      <p class="desc">–° –ø–µ–Ω–∫–æ–π</p>
      <p class="price">180‚ÇΩ</p>
      <button onclick="openModal('–ö–∞–ø—É—á–∏–Ω–æ',180)">–í –∫–æ—Ä–∑–∏–Ω—É</button>
    </div>
  </div>
</div>

<!-- –î–µ—Å–µ—Ä—Ç—ã -->
<div class="section">
  <h2>–î–µ—Å–µ—Ä—Ç—ã</h2>
  <div class="cards">
    <div class="card">
      <img src="https://images.unsplash.com/photo-1587314168485-3236d6710814?auto=format&fit=crop&w=300&q=80">
      <h3>–ö—Ä—É–∞—Å—Å–∞–Ω</h3>
      <p class="desc">–•—Ä—É—Å—Ç—è—â–∏–π</p>
      <p class="price">120‚ÇΩ</p>
      <button onclick="addToCart('–ö—Ä—É–∞—Å—Å–∞–Ω',120)">–í –∫–æ—Ä–∑–∏–Ω—É</button>
    </div>
    <div class="card">
      <img src="https://images.unsplash.com/photo-1607478900766-efe13248b125?auto=format&fit=crop&w=300&q=80">
      <h3>–ß–∏–∑–∫–µ–π–∫</h3>
      <p class="desc">–ù–µ–∂–Ω—ã–π</p>
      <p class="price">220‚ÇΩ</p>
      <button onclick="addToCart('–ß–∏–∑–∫–µ–π–∫',220)">–í –∫–æ—Ä–∑–∏–Ω—É</button>
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ -->
<div id="modal" class="modal">
  <div class="modal-content">
    <h3>–ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã</h3>
    <label><input type="checkbox" id="sugar"> –°–∞—Ö–∞—Ä (+0‚ÇΩ)</label><br>
    <label><input type="checkbox" id="vanilla"> –í–∞–Ω–∏–ª—å (+20‚ÇΩ)</label><br>
    <label><input type="checkbox" id="caramel"> –ö–∞—Ä–∞–º–µ–ª—å (+20‚ÇΩ)</label><br>
    <label><input type="checkbox" id="chocolate"> –®–æ–∫–æ–ª–∞–¥ (+20‚ÇΩ)</label><br>
    <button onclick="confirmModal()">–î–∞–ª–µ–µ –∫ –≤—Ä–µ–º–µ–Ω–∏</button>
    <button onclick="closeModal()">–û—Ç–º–µ–Ω–∞</button>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Ä–µ–º–µ–Ω–∏ -->
<div id="timeModal" class="modal">
  <div class="modal-content">
    <h3>–ö–æ–≥–¥–∞ –ø—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å?</h3>
    <button class="time-btn" onclick="selectTime('–°–µ–π—á–∞—Å')">–í –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è</button>
    <button class="time-btn" onclick="selectTime('–ß–µ—Ä–µ–∑ 30 –º–∏–Ω')">–ß–µ—Ä–µ–∑ 30 –º–∏–Ω—É—Ç</button>
    <button class="time-btn" onclick="selectTime('–ß–µ—Ä–µ–∑ 1 —á–∞—Å')">–ß–µ—Ä–µ–∑ 1 —á–∞—Å</button>
    <label>–°–≤–æ–π –≤–∞—Ä–∏–∞–Ω—Ç: <input type="time" id="customTime"></label>
    <button onclick="selectCustom()">–°–≤–æ–π –≤–∞—Ä–∏–∞–Ω—Ç</button>
  </div>
</div>

<!-- –ö–æ—Ä–∑–∏–Ω–∞ + —É–¥–∞–ª–µ–Ω–∏–µ -->
<div id="cart" class="modal-content" style="position:relative;margin:20px 8px;max-width:400px">
  <h2>–ö–æ—Ä–∑–∏–Ω–∞</h2>
  <ul id="cart-list"></ul>
  <p id="timeLine">–í—Ä–µ–º—è: –Ω–µ –≤—ã–±—Ä–∞–Ω–æ</p>
  <p>–ò—Ç–æ–≥–æ: <span id="total">0</span>‚ÇΩ</p>
  <button onclick="removeAll()" class="del-btn">–û—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É</button>
  <button onclick="pay()" class="action">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ ¬´–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–∫–∞–∑¬ª (–¥–æ–±–∞–≤—å—Ç–µ —ç—Ç–æ—Ç –±–ª–æ–∫) -->
<div id="checkoutModal" class="modal">
  <div class="modal-content">
    <h3>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–∫–∞–∑</h3>
    <p><b>–ê–¥—Ä–µ—Å –∫–æ—Ñ–µ–π–Ω–∏:</b> —É–ª. –õ–µ–Ω–∏–Ω–∞, 10 (BrewPoint)</p>
    <ul id="finalList"></ul>
    <p><b>–°—É–º–º–∞:</b> <span id="finalTotal">0</span>‚ÇΩ</p>
    <p><b>–í—Ä–µ–º—è:</b> <span id="finalTime">‚Äî</span></p>
    <button onclick="closeCheckout()">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –∫–∞—Ç–∞–ª–æ–≥—É</button>
    <button onclick="pay()">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
  </div>
</div>

<script>
  let cart = [];
  let selectedTime = null;
  let currentItem = null;

  /* ---------- –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã ---------- */
  function openModal(name, price){
    currentItem = {name, price};
    document.getElementById('modal').style.display = 'block';
  }
  function closeModal(){
    document.getElementById('modal').style.display = 'none';
  }
  function confirmModal(){
    let total = currentItem.price;
    const mods = [];
    if(document.getElementById('sugar').checked) mods.push('—Å–∞—Ö–∞—Ä');
    if(document.getElementById('vanilla').checked){ mods.push('–≤–∞–Ω–∏–ª—å'); total += 20; }
    if(document.getElementById('caramel').checked){ mods.push('–∫–∞—Ä–∞–º–µ–ª—å'); total += 20; }
    if(document.getElementById('chocolate').checked){ mods.push('—à–æ–∫–æ–ª–∞–¥'); total += 20; }
    const name = currentItem.name + (mods.length ? ' (' + mods.join(', ') + ')' : '');
    currentItem = {name, price: total};
    closeModal();
    openTimeModal();
  }

  /* ---------- –≤—Ä–µ–º—è ---------- */
  function openTimeModal(){
    document.getElementById('timeModal').style.display = 'block';
  }
  function closeTimeModal(){
    document.getElementById('timeModal').style.display = 'none';
  }
  function selectTime(time){
    selectedTime = time;
    addToCart(currentItem.name, currentItem.price);
    closeTimeModal();
  }
  function selectCustom(){
    const val = document.getElementById('customTime').value;
    if (!val) { alert('–£–∫–∞–∂–∏—Ç–µ –≤—Ä–µ–º—è'); return; }
    selectedTime = val;
    addToCart(currentItem.name, currentItem.price);
    closeTimeModal();
  }

  /* ---------- –∫–æ—Ä–∑–∏–Ω–∞ + —É–¥–∞–ª–µ–Ω–∏–µ ---------- */
  function addToCart(name, price){
    cart.push({name, price, time: selectedTime});
    updateCart();
  }
  function updateCart(){
    const list = document.getElementById('cart-list');
    list.innerHTML = '';
    cart.forEach((item, idx) =>
      list.innerHTML += `<li>${item.name} ${item.price}‚ÇΩ ‚Äì ${item.time}
        <button class="del-btn" onclick="removeItem(${idx})">√ó</button></li>`
    );
    document.getElementById('total').textContent = cart.reduce((s,i)=>s+i.price,0);
    document.getElementById('timeLine').textContent = `–í—Ä–µ–º—è: ${selectedTime || '–Ω–µ –≤—ã–±—Ä–∞–Ω–æ'}`;
  }
  function removeItem(index){
    cart.splice(index,1);
    updateCart();
  }
  function removeAll(){
    cart = [];
    updateCart();
  }

  /* ---------- –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ ---------- */
  function pay(){
    if(cart.length === 0){ alert('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞'); return; }
    const orderList = cart.map(i => `${i.name} ${i.price}‚ÇΩ ‚Äì ${i.time}`).join('<br>');
    document.getElementById('successList').innerHTML = orderList;
    document.getElementById('orderNumber').textContent = Math.floor(Math.random()*90000)+10000;
    document.getElementById('checkoutModal').style.display = 'none';
    document.getElementById('successModal').style.display = 'block';
  }

  /* ---------- –∑–∞–∫—Ä—ã—Ç–∏–µ –º–∏–Ω–∏-–∞–ø + —Å–æ–æ–±—â–µ–Ω–∏–µ ---------- */
  function closeMiniApp(){
    const msg = `‚úÖ –ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω!\n\nüìã –°–æ—Å—Ç–∞–≤:\n${cart.map(i=>`${i.name} ${i.price}‚ÇΩ ‚Äì ${i.time}`).join('\n')}\nüí∞ –°—É–º–º–∞: ${cart.reduce((s,i)=>s+i.price,0)}‚ÇΩ`;
    Telegram.WebApp.sendData(JSON.stringify({command:'order', items: cart, total: cart.reduce((s,i)=>s+i.price,0), time: selectedTime}));
    Telegram.WebApp.close();
  }
</script>
</body>
</html>
